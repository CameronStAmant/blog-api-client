(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),a=n(19),c=n.n(a),o=(n(28),n(2)),l=n(9),i=n(3),u=(n(29),n(8)),d=n.n(u),j=n(10),b=n(0);var m=function(e){return Object(b.jsx)(l.c,{to:e.link,className:"display: block",children:Object(b.jsx)("li",{className:"sm:col-start-3 lg:col-start-4 border-solid border-4 border-green-700 rounded-md bg-green-700 hover:bg-green-800 hover:border-green-800 active:bg-green-900 active:border-green-900 shadow-sm px-md text-base",children:e.text})})},h=function(e){return Object(b.jsx)("div",{className:"grid grid-cols-3 row-start-1 bg-gradient-to-b from-green-900 to-green-400 py-2 text-white text-center text-lg",children:Object(b.jsxs)("ul",{className:"flex space-x-3 col-span-full grid-flow-col place-items-center mx-4",children:[Object(b.jsx)(m,{link:"/",text:"Home"}),!e.authState&&Object(b.jsx)(m,{link:"/login",text:"Login"}),!e.authState&&Object(b.jsx)(m,{link:"/signup",text:"Sign up"}),e.authState&&Object(b.jsx)(m,{link:"/logout",text:"Log out"})]})})},x=function(){return Object(b.jsxs)("ul",{className:"flex text-center content-evenly mx-4 row-start-3 col-span-full",children:[Object(b.jsx)("li",{className:"flex-1",children:"Privacy"}),Object(b.jsx)("li",{className:"flex-1",children:"About"}),Object(b.jsx)("li",{className:"flex-1",children:"Contact us"})]})},f=function(e){return Object(b.jsx)("div",{className:"bg-gray-600 min-h-screen",children:Object(b.jsxs)("div",{className:"grid grid-rows-layout p-0 m-0 list-none max-w-screen-xl mx-auto min-h-screen bg-gray-100",children:[Object(b.jsx)(h,{authState:e.authState}),e.children,Object(b.jsx)(x,{})]})})},O="https://serene-waters-04286.herokuapp.com";var p=function(e){return Object(b.jsx)("li",{children:Object(b.jsx)(l.b,{to:"/posts/"+e.post.id,children:Object(b.jsxs)("div",{className:"grid auto-rows-post",children:[Object(b.jsx)("div",{className:"overflow-hidden h-postCoverPhoto",children:Object(b.jsx)("img",{className:"w-full rounded-tl-md rounded-tr-md",src:e.post?O+"/uploads/"+e.post.coverPhoto:"",alt:"Post Cover"})}),Object(b.jsx)("div",{className:"text-2xl font-semibold flex-grow pl-md rounded-bl-md rounded-br-md bg-white -mt-1 pt-sm pb-1",children:e.post.title})]})})})},g=function(e){var t=Object(r.useState)(null),n=Object(o.a)(t,2),s=n[0],a=n[1];return Object(r.useEffect)((function(){(function(){var e=Object(j.a)(d.a.mark((function e(){var t,n,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O+"/posts",{mode:"cors"});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r=n.posts,s=r.map((function(e){return!0===e.published?Object(b.jsx)("li",{className:"box-border shadow-sm rounded-md h-full",children:Object(b.jsx)(p,{post:e})},e.title):null})),a(s);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(b.jsx)(f,{authState:e.authState,children:Object(b.jsxs)("div",{className:"grid grid-rows-home row-start-2 mx-4",children:[Object(b.jsx)("h2",{className:"place-self-center text-3xl text-green-900",children:"Welcome to the blog!"}),Object(b.jsx)("ul",{className:"grid md:grid-cols-2 auto-rows-min lg:grid-cols-3 gap-4",children:s||""})]})})};var v=function(e){return Object(b.jsx)(g,{authState:e.authState})};var w=function(e){return Object(b.jsx)("button",{onClick:e.onClick,className:"border-solid border-4 rounded-md shadow-sm  px-md text-base ".concat("green"===e.color?"border-green-200 bg-green-200 hover:bg-green-300 hover:border-green-300 active:bg-green-400 active:border-green-400":"border-red-200 bg-red-200 hover:bg-red-300 hover:border-red-300 active:bg-red-400 active:border-red-400"," ").concat(e.addonClasses),type:e.type?e.type:"button",children:e.value})};var S=function(e){return Object(b.jsx)("input",{className:"\n      border-2\n      rounded-md\n      box-border\n      border-green-200\n      focus:border-green-500\n      shadow-sm\n      block\n      mb-2\n    ".concat(e.addonClasses),type:e.type,id:e.id,name:e.name,autoComplete:"on",value:e.value,onChange:e.onChange,required:!0})},y=function(e){var t=Object(r.useState)(null),n=Object(o.a)(t,2),s=n[0],a=n[1],c=Object(r.useState)(null),l=Object(o.a)(c,2),u=l[0],d=l[1],j=Object(r.useState)(null),m=Object(o.a)(j,2),h=m[0],x=m[1],p=Object(r.useState)(null),g=Object(o.a)(p,2),v=g[0],y=g[1];return Object(b.jsxs)(f,{children:[h&&Object(b.jsx)(i.a,{to:"/",push:!0}),Object(b.jsxs)("div",{className:"grid place-content-center",children:[Object(b.jsxs)("form",{className:"text-center",children:[Object(b.jsx)("label",{htmlFor:"username-field",children:"Username"}),Object(b.jsx)(S,{type:"text",id:"username-field",name:"username",value:s||"",onChange:function(e){return a(e.target.value)}}),Object(b.jsx)("label",{htmlFor:"password-field",children:"Password"}),Object(b.jsx)(S,{type:"password",id:"password-field",name:"password",value:u||"",onChange:function(e){return d(e.target.value)}}),Object(b.jsx)(w,{value:"Login",color:"green",type:"submit",onClick:function(t){t.preventDefault();var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:u,adminSite:!1})};fetch(O+"/login",n).then((function(e){return e.json()})).then((function(t){void 0!==t.token?(window.localStorage.setItem("user",t.token),e.authRefresh(!0),x(!0)):y(t.message)}))}})]}),v&&Object(b.jsx)("p",{className:"row-start-4",children:v})]})]})},N=function(e){return Object(r.useEffect)((function(){window.localStorage.removeItem("user"),e.authRefresh(!0)})),Object(b.jsx)(i.a,{to:"/"})},C=function(){var e=Object(r.useState)(null),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(null),c=Object(o.a)(a,2),l=c[0],u=c[1],d=Object(r.useState)(null),j=Object(o.a)(d,2),m=j[0],h=j[1],x=Object(r.useState)(""),p=Object(o.a)(x,2),g=p[0],v=p[1],y=Object(i.g)();return Object(b.jsx)(f,{children:Object(b.jsxs)("div",{className:"grid place-content-center",children:[Object(b.jsxs)("form",{className:"text-center row-start-2 self-end",children:[Object(b.jsx)("label",{htmlFor:"username-field",children:"Username"}),Object(b.jsx)(S,{type:"text",id:"username-field",name:"username",value:n||"",onChange:function(e){return s(e.target.value)}}),Object(b.jsx)("label",{htmlFor:"email-field",children:"Email"}),Object(b.jsx)(S,{type:"email",id:"email-field",name:"email",value:l||"",onChange:function(e){return u(e.target.value)}}),Object(b.jsx)("label",{htmlFor:"password-field",children:"Password"}),Object(b.jsx)(S,{type:"password",id:"password-field",name:"password",value:m||"",onChange:function(e){return h(e.target.value)}}),Object(b.jsx)("label",{htmlFor:"password-confirmation-field",children:"Confirm Password"}),Object(b.jsx)(S,{type:"password",id:"password-confirmation-field",name:"password-confirmation",value:g||"",onChange:function(e){return v(e.target.value)}}),Object(b.jsx)(w,{value:"Login",color:"green",type:"submit",onClick:function(e){if(e.preventDefault(),m===g){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,email:l,password:m})};fetch(O+"/signup",t).then((function(){return y.push("/login")}))}}})]}),Object(b.jsx)("p",{className:"row-start-3",children:m!==g&&""!==g?"The passwords do not match":""})]})})};var k=function(e){return Object(b.jsx)("textarea",{className:"box-border border-2 shadow-sm rounded-md gap-4 border-green-200 auto-rows-min w-full block mb-2",rows:"12",name:"body",value:e.value?e.value:"",onChange:e.onChange,required:!0})},I=function(e){var t=Object(r.useState)(null),n=Object(o.a)(t,2),s=n[0],a=n[1],c=Object(i.h)().id,l=function(){var t=Object(j.a)(d.a.mark((function t(n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")},body:JSON.stringify({author:e.userId,body:s})},t.next=4,fetch(O+"/posts/"+c+"/comments",r);case 4:e.setComments(),a(null),e.loadComments();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(r.useEffect)((function(){}),[e.comments]),Object(b.jsx)("div",{className:"gap-4",children:e.authState&&Object(b.jsxs)("form",{className:"mt-14 text-center",children:[Object(b.jsx)("label",{className:"",children:"Comment"}),Object(b.jsx)(k,{value:s,onChange:function(e){return a(e.target.value)}}),Object(b.jsx)(w,{value:"Submit",color:"green",onClick:l})]})})},P=n(23),T=n(22),E=n(37).DateTime,D=function(e){return Object(r.useEffect)((function(){(function(){var t=Object(j.a)(d.a.mark((function t(){var n,r,s,a,c,o,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(O+"/posts/"+e.postid+"/comments",{mode:"cors"});case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,s=[],a=Object(T.a)(r.comments);try{for(a.s();!(c=a.n()).done;)o=c.value,l=Object(b.jsxs)("div",{className:"box-border border-solid shadow-md p-smd grid gap-2 auto-rows-min border-2 border-green-200 rounded-md mb-2",children:[Object(b.jsx)("h4",{className:"text-green-900 font-bold",children:o.author.username}),Object(b.jsx)("p",{className:"italic text-sm",children:E.fromISO(o.timestamp).toLocaleString(E.DATETIME_MED)}),Object(b.jsx)("p",{className:"row-start-2",children:o.body})]},o._id),s=[].concat(Object(P.a)(s),[l])}catch(i){a.e(i)}finally{a.f()}e.setComments(s);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e.loadComments]),Object(b.jsx)("div",{className:"justify-self-stretch my-14",children:e.comments})},F=function(e){var t=Object(r.useState)(null),n=Object(o.a)(t,2),s=n[0],a=n[1],c=Object(i.h)().id,l=Object(r.useState)(!1),u=Object(o.a)(l,2),m=u[0],h=u[1],x=Object(r.useState)([]),p=Object(o.a)(x,2),g=p[0],v=p[1];return Object(r.useEffect)((function(){(function(){var e=Object(j.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O+"/posts/"+c,{mode:"cors",headers:{Authorization:"Bearer "+localStorage.getItem("user")}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r=n.post,a(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(b.jsx)(f,{authState:e.authState,children:Object(b.jsxs)("div",{className:"display: grid auto-rows-min auto-rows-auto row-start-2 col-span-full mx-4",children:[Object(b.jsxs)("div",{className:"display: grid grid-rows-postTitle",children:[Object(b.jsx)("h2",{className:"row-start-1 place-self-center text-3xl text-green-900",children:s?s.title:""}),Object(b.jsx)("div",{className:"overflow-hidden h-postCoverPhoto rounded-md",children:Object(b.jsx)("img",{className:"w-full",src:s?O+"/uploads/"+s.coverPhoto:"",alt:"Post Cover"})}),Object(b.jsxs)("p",{className:"mx-2 p-smd",children:[" ",s?s.body:""]})]}),e.authState&&Object(b.jsx)(I,{authState:e.authState,userId:e.userId,loadComments:function(){return h(!m)},setComments:function(){return v([])},comments:g}),Object(b.jsx)(D,{postid:c,loadComments:m,setComments:function(e){return v(e)},comments:g})]})})},A=function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(null),c=Object(o.a)(a,2),u=(c[0],c[1]),d=Object(r.useState)(null),j=Object(o.a)(d,2),m=j[0],h=j[1],x=Object(r.useState)(!1),f=Object(o.a)(x,2),p=f[0],g=f[1];return Object(r.useEffect)((function(){!function(){var e={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")}};localStorage.getItem("user")?fetch(O+"/auth",e).then((function(e){return e.json()})).then((function(e){s(e.response),u(e.username),h(e.userId),g(!1)})):(s(!1),u(null),h(null),g(!1))}()}),[p]),Object(b.jsx)(l.a,{forceRefresh:!0,children:Object(b.jsxs)(i.d,{children:[Object(b.jsx)(i.b,{exact:!0,path:"/",render:function(){return Object(b.jsx)(v,{authState:n})}}),Object(b.jsx)(i.b,{exact:!0,path:"/login",render:function(){return Object(b.jsx)(y,{authRefresh:function(e){return g(e)}})}}),Object(b.jsx)(i.b,{exact:!0,path:"/signUp",component:C}),Object(b.jsx)(i.b,{exact:!0,path:"/logout",render:function(){return Object(b.jsx)(N,{authRefresh:function(e){return g(e)}})}}),Object(b.jsx)(i.b,{exact:!0,path:"/posts/:id",render:function(){return Object(b.jsx)(F,{authState:n,userId:m})}})]})})};c.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(A,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.10fa78d8.chunk.js.map