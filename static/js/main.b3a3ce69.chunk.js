(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),r=n(20),a=n.n(r),o=(n(28),n(2)),u=n(5),i=n(3),j=(n(29),n(8)),l=n.n(j),b=n(10),d=(n(31),n(32),n(0)),m=function(e){return Object(d.jsx)("div",{className:"header",children:Object(d.jsxs)("ul",{className:"headerNav",children:[Object(d.jsx)("li",{children:Object(d.jsx)(u.c,{to:"/",children:"Home"})}),!e.authState&&Object(d.jsx)("li",{children:Object(d.jsx)(u.c,{to:"/login",children:"Login"})}),!e.authState&&Object(d.jsx)("li",{children:Object(d.jsx)(u.c,{to:"/signup",children:"Sign up"})}),e.authState&&Object(d.jsx)("li",{children:Object(d.jsx)(u.c,{to:"/logout",children:"Log out"})})]})})},h=(n(39),function(){return Object(d.jsx)("div",{className:"footer",children:Object(d.jsxs)("ul",{className:"footerNav",children:[Object(d.jsx)("li",{children:"Privacy"}),Object(d.jsx)("li",{children:"About"}),Object(d.jsx)("li",{children:"Contact us"})]})})}),O=(n(40),function(e){return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(m,{authState:e.authState}),e.children,Object(d.jsx)(h,{})]})}),p=function(e){var t=Object(c.useState)(null),n=Object(o.a)(t,2),s=n[0],r=n[1];return Object(c.useEffect)((function(){(function(){var e=Object(b.a)(l.a.mark((function e(){var t,n,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://serene-waters-04286.herokuapp.com/posts",{mode:"cors"});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c=n.posts,s=c.map((function(e){return!0===e.published?Object(d.jsx)("li",{className:"postDetails",children:Object(d.jsx)(u.b,{to:"/posts/"+e.id,children:e.title})},e.title):null})),r(s);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(d.jsx)(O,{authState:e.authState,children:Object(d.jsxs)("div",{className:"mainContentHome",children:[Object(d.jsx)("div",{className:"homeBanner",children:"Welcome to the blog!"}),Object(d.jsx)("ul",{className:"postIndex",children:s||""})]})})};var f=function(e){return Object(d.jsx)("div",{children:Object(d.jsx)(p,{authState:e.authState})})},x=(n(41),function(e){var t=Object(c.useState)(null),n=Object(o.a)(t,2),s=n[0],r=n[1],a=Object(c.useState)(null),u=Object(o.a)(a,2),j=u[0],l=u[1],b=Object(c.useState)(null),m=Object(o.a)(b,2),h=m[0],p=m[1],f=Object(c.useState)(null),x=Object(o.a)(f,2),v=x[0],S=x[1];return Object(d.jsxs)(O,{children:[h&&Object(d.jsx)(i.a,{to:"/",push:!0}),Object(d.jsx)("div",{className:"mainContent",children:Object(d.jsxs)("form",{onSubmit:function(t){t.preventDefault();var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:j,adminSite:!1})};fetch("https://serene-waters-04286.herokuapp.com/login",n).then((function(e){return e.json()})).then((function(t){void 0!==t.token?(window.localStorage.setItem("user",t.token),e.authRefresh(!0),p(!0)):S(t.message)}))},className:"login-form",children:[Object(d.jsx)("label",{htmlFor:"username-field",children:"Username:"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"text",id:"username-field",name:"username",autoComplete:"on",value:s||"",onChange:function(e){return r(e.target.value)},required:!0}),Object(d.jsx)("br",{}),Object(d.jsx)("label",{htmlFor:"password-field",children:"Password:"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"password",id:"password-field",name:"password",autoComplete:"on",value:j||"",onChange:function(e){return l(e.target.value)},required:!0}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"submit",id:"loginButton",value:"Login"}),v&&Object(d.jsx)("div",{children:v})]})})]})}),v=function(e){return Object(c.useEffect)((function(){window.localStorage.removeItem("user"),e.authRefresh(!0)})),Object(d.jsx)(i.a,{to:"/"})},S=(n(42),function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(null),a=Object(o.a)(r,2),u=a[0],j=a[1],l=Object(c.useState)(null),b=Object(o.a)(l,2),m=b[0],h=b[1],p=Object(c.useState)(null),f=Object(o.a)(p,2),x=f[0],v=f[1],S=Object(i.g)();return Object(d.jsx)(O,{children:Object(d.jsx)("div",{className:"mainContent",children:Object(d.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),m===x){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,email:u,password:m})};fetch("https://serene-waters-04286.herokuapp.com/signup",t).then((function(){return S.push("/login")}))}},className:"Sign-up-form",children:[Object(d.jsx)("label",{htmlFor:"username-field",children:"Username:"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"text",id:"username-field",name:"username",autoComplete:"on",value:n||"",onChange:function(e){return s(e.target.value)},required:!0}),Object(d.jsx)("br",{}),Object(d.jsx)("label",{htmlFor:"email-field",children:"Email:"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"email",id:"email-field",name:"email",autoComplete:"on",value:u||"",onChange:function(e){return j(e.target.value)},required:!0}),Object(d.jsx)("br",{}),Object(d.jsx)("label",{htmlFor:"password-field",children:"Password:"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"password",id:"password-field",name:"password",autoComplete:"on",value:m||"",onChange:function(e){return h(e.target.value)},required:!0}),Object(d.jsx)("br",{}),Object(d.jsx)("label",{htmlFor:"password-confirmation-field",children:"Confirm Password:"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"password",id:"password-confirmation-field",name:"password-confirmation",autoComplete:"on",value:x||"",onChange:function(e){return v(e.target.value)},required:!0}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"submit",id:"signUpSubmit",value:"Sign Up"}),m!==x?"The passwords do not match":""]})})})}),g=(n(43),n(44),function(e){var t=Object(c.useState)(null),n=Object(o.a)(t,2),s=n[0],r=n[1],a=Object(i.h)().id,u=function(){var t=Object(b.a)(l.a.mark((function t(n){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),c={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")},body:JSON.stringify({author:e.userId,body:s})},t.next=4,fetch("https://serene-waters-04286.herokuapp.com/posts/"+a+"/comments",c);case 4:e.setComments(),r(null),e.loadComments();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){}),[e.comments]),Object(d.jsx)("div",{className:"form",children:e.authState&&Object(d.jsxs)("div",{className:"commentForm",children:[Object(d.jsx)("h3",{children:"Submit a comment"}),Object(d.jsx)("br",{}),Object(d.jsxs)("form",{onSubmit:u,children:[Object(d.jsx)("label",{children:"Comment:"}),Object(d.jsx)("br",{}),Object(d.jsx)("textarea",{type:"text",rows:"5",name:"body",value:s||"",onChange:function(e){return r(e.target.value)},required:!0}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"hidden",value:a,name:"post"}),Object(d.jsx)("input",{type:"submit",id:"commentSubmit",value:"Submit"})]})]})})}),w=n(23),y=n(22),C=(n(45),n(46).DateTime),N=function(e){return Object(c.useEffect)((function(){(function(){var t=Object(b.a)(l.a.mark((function t(){var n,c,s,r,a,o,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://serene-waters-04286.herokuapp.com/posts/"+e.postid+"/comments",{mode:"cors"});case 2:return n=t.sent,t.next=5,n.json();case 5:c=t.sent,s=[],r=Object(y.a)(c.comments);try{for(r.s();!(a=r.n()).done;)o=a.value,u=Object(d.jsxs)("div",{className:"commentLayout",children:[Object(d.jsx)("h4",{className:"commentAuthor",children:o.author.username}),Object(d.jsx)("p",{className:"commentTimestamp",children:C.fromISO(o.timestamp).toLocaleString(C.DATETIME_MED)}),Object(d.jsx)("p",{className:"commentBody",children:o.body}),Object(d.jsx)("br",{})]},o._id),s=[].concat(Object(w.a)(s),[u])}catch(i){r.e(i)}finally{r.f()}e.setComments(s);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e.loadComments]),Object(d.jsx)("div",{className:"Comment",children:e.comments})},k=function(e){var t=Object(c.useState)(null),n=Object(o.a)(t,2),s=n[0],r=n[1],a=Object(i.h)().id,u=Object(c.useState)(!1),j=Object(o.a)(u,2),m=j[0],h=j[1],p=Object(c.useState)([]),f=Object(o.a)(p,2),x=f[0],v=f[1];return Object(c.useEffect)((function(){(function(){var e=Object(b.a)(l.a.mark((function e(){var t,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://serene-waters-04286.herokuapp.com/posts/"+a,{mode:"cors",headers:{Authorization:"Bearer "+localStorage.getItem("user")}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c=n.post,r(c);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(d.jsx)(O,{authState:e.authState,children:Object(d.jsxs)("div",{className:"postLayout",children:[Object(d.jsxs)("div",{className:"post",children:[Object(d.jsx)("h2",{children:s?s.title:""}),Object(d.jsx)("br",{}),Object(d.jsxs)("p",{children:[" ",s?s.body:""]})]}),Object(d.jsx)(g,{authState:e.authState,userId:e.userId,loadComments:function(){return h(!m)},setComments:function(){return v([])},comments:x}),Object(d.jsx)(N,{postid:a,loadComments:m,setComments:function(e){return v(e)},comments:x})]})})},I=function(){var e=Object(c.useState)(!1),t=Object(o.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(null),a=Object(o.a)(r,2),j=(a[0],a[1]),l=Object(c.useState)(null),b=Object(o.a)(l,2),m=b[0],h=b[1],O=Object(c.useState)(!1),p=Object(o.a)(O,2),g=p[0],w=p[1];return Object(c.useEffect)((function(){!function(){var e={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("user")}};localStorage.getItem("user")?fetch("https://serene-waters-04286.herokuapp.com/auth",e).then((function(e){return e.json()})).then((function(e){s(e.response),j(e.username),h(e.userId),w(!1)})):(s(!1),j(null),h(null),w(!1))}()}),[g]),Object(d.jsx)(u.a,{forceRefresh:!0,children:Object(d.jsxs)(i.d,{children:[Object(d.jsx)(i.b,{exact:!0,path:"/",render:function(){return Object(d.jsx)(f,{authState:n})}}),Object(d.jsx)(i.b,{exact:!0,path:"/login",render:function(){return Object(d.jsx)(x,{authRefresh:function(e){return w(e)}})}}),Object(d.jsx)(i.b,{exact:!0,path:"/signUp",component:S}),Object(d.jsx)(i.b,{exact:!0,path:"/logout",render:function(){return Object(d.jsx)(v,{authRefresh:function(e){return w(e)}})}}),Object(d.jsx)(i.b,{exact:!0,path:"/posts/:id",render:function(){return Object(d.jsx)(k,{authState:n,userId:m})}})]})})};a.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(I,{})}),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.b3a3ce69.chunk.js.map